version: "1"
services:
  - type: web
    name: al-marya-rostery-backend
    env: node
    plan: standard
    region: oregon
    runtime: node20
    rootDir: backend
    buildCommand: npm ci --only=production
    startCommand: npm start
    
    # Health check configuration
    healthCheckPath: /health
    healthCheckTimeout: 30
    
    # Auto-deploy on git push
    autoDeploy: true
    
    # Watch for changes in backend directory
    buildFilter:
      paths:
      - backend/**
    
    # Environment variables
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
        
    # Disk storage for uploads
    disk:
      name: uploads
      mountPath: /opt/render/project/src/uploads
      sizeGB: 1
